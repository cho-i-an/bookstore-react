{"ast":null,"code":"// import {Dispatch, ReducerAction} from \"react\";\n\nexport const CartTypes = {\n  ADD: 'ADD',\n  REMOVE: 'REMOVE',\n  CLEAR: 'CLEAR'\n};\n// this is used by the reducer. You can define it on the CartReducer\nexport const initialCartState = [];\nconst findItem = (cart, id) => cart.find(book => book.id === id);\nexport const cartReducer = (state, action) => {\n  switch (action.type) {\n    case CartTypes.ADD:\n      if (findItem(state, action.item.bookId)) {\n        return state.map(book => book.id === action.item.bookId ? {\n          ...book,\n          quantity: book.quantity + 1\n        } : book);\n      } else {\n        console.log(\"state\", ...state, {\n          id: action.id,\n          items: action.item,\n          quantity: 1\n        });\n        return [...state, {\n          id: action.id,\n          items: action.item,\n          quantity: 1\n        }];\n      }\n    case CartTypes.REMOVE:\n      /*\n         will be defiend in Project 7\n       */\n      if (findItem(state, action.book.bookId)) {\n        const newState = state.map(book => book.id === action.book.bookId ? {\n          ...book,\n          quantity: book.quantity - 1\n        } : book).filter(book => book.quantity >= 1);\n        localStorage.setItem('cart', JSON.stringify(newState));\n        return newState;\n        // return state.map((book) =>\n        //         book.id === action.book.bookId\n        //             ? { ...book, quantity: book.quantity - 1 }\n        //             : book\n        //     )\n        //     .filter((book) => book.quantity >= 1);\n      } else {\n        localStorage.setItem('cart', JSON.stringify(state));\n        return state;\n      }\n    case CartTypes.CLEAR:\n      const newState = initialCartState;\n      localStorage.setItem('cart', JSON.stringify(newState));\n      // state = initialCartState;\n      return newState;\n    default:\n      throw new Error(`Invalid action type ${action.type}`);\n  }\n};","map":{"version":3,"names":["CartTypes","ADD","REMOVE","CLEAR","initialCartState","findItem","cart","id","find","book","cartReducer","state","action","type","item","bookId","map","quantity","console","log","items","newState","filter","localStorage","setItem","JSON","stringify","Error"],"sources":["/Users/ann/Desktop/CS5244/IAnBookstoreReactSession/client/src/reducers/CartReducer.tsx"],"sourcesContent":["import {ShoppingCartItem, BookItem} from \"../types\";\n// import {Dispatch, ReducerAction} from \"react\";\n\n\nexport const CartTypes = {\n    ADD: 'ADD',\n    REMOVE: 'REMOVE',\n    CLEAR: 'CLEAR'\n};\n\nexport type AppActions = {\n    id: number;\n    type: 'ADD' | 'REMOVE' | 'CLEAR';\n    item: BookItem;\n}\n\n// this is used by the reducer. You can define it on the CartReducer\nexport const initialCartState: ShoppingCartItem[] = [];\n\n\nconst findItem = (cart: any[], id: number) => cart.find((book) => book.id === id);\n\nexport const cartReducer = (state: ShoppingCartItem[], action: AppActions) => {\n\n    switch (action.type) {\n        case CartTypes.ADD:\n\n\n            if (findItem(state, action.item.bookId)) {\n\n                return state.map((book) => book.id === action.item.bookId ? {\n                    ...book,\n                    quantity: book.quantity + 1\n                } : book);\n            } else {\n\n                console.log(\"state\",\n                    ...state,\n                    {id: action.id,items:action.item, quantity: 1 },\n                );\n                return [\n                    ...state,\n                    {\n                        id: action.id,\n                        items: action.item,\n                        quantity: 1\n                    }\n                ];\n            }\n\n\n\n        case CartTypes.REMOVE:\n\n            /*\n               will be defiend in Project 7\n             */\n            if (findItem(state, action.book.bookId)) {\n                const newState = state.map((book) =>\n                    book.id === action.book.bookId\n                        ? { ...book, quantity: book.quantity - 1 }\n                        : book\n                )\n                    .filter((book) => book.quantity >= 1);\n\n                localStorage.setItem('cart', JSON.stringify(newState));\n                return newState\n                // return state.map((book) =>\n                //         book.id === action.book.bookId\n                //             ? { ...book, quantity: book.quantity - 1 }\n                //             : book\n                //     )\n                //     .filter((book) => book.quantity >= 1);\n            }else{\n                localStorage.setItem('cart', JSON.stringify(state));\n                return state\n            }\n\n\n        case CartTypes.CLEAR:\n            const newState = initialCartState\n            localStorage.setItem('cart', JSON.stringify(newState));\n            // state = initialCartState;\n            return newState;\n        default:\n            throw new Error(`Invalid action type ${action.type}`);\n    }\n};"],"mappings":"AACA;;AAGA,OAAO,MAAMA,SAAS,GAAG;EACrBC,GAAG,EAAE,KAAK;EACVC,MAAM,EAAE,QAAQ;EAChBC,KAAK,EAAE;AACX,CAAC;AAQD;AACA,OAAO,MAAMC,gBAAoC,GAAG,EAAE;AAGtD,MAAMC,QAAQ,GAAGA,CAACC,IAAW,EAAEC,EAAU,KAAKD,IAAI,CAACE,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACF,EAAE,KAAKA,EAAE,CAAC;AAEjF,OAAO,MAAMG,WAAW,GAAGA,CAACC,KAAyB,EAAEC,MAAkB,KAAK;EAE1E,QAAQA,MAAM,CAACC,IAAI;IACf,KAAKb,SAAS,CAACC,GAAG;MAGd,IAAII,QAAQ,CAACM,KAAK,EAAEC,MAAM,CAACE,IAAI,CAACC,MAAM,CAAC,EAAE;QAErC,OAAOJ,KAAK,CAACK,GAAG,CAAEP,IAAI,IAAKA,IAAI,CAACF,EAAE,KAAKK,MAAM,CAACE,IAAI,CAACC,MAAM,GAAG;UACxD,GAAGN,IAAI;UACPQ,QAAQ,EAAER,IAAI,CAACQ,QAAQ,GAAG;QAC9B,CAAC,GAAGR,IAAI,CAAC;MACb,CAAC,MAAM;QAEHS,OAAO,CAACC,GAAG,CAAC,OAAO,EACf,GAAGR,KAAK,EACR;UAACJ,EAAE,EAAEK,MAAM,CAACL,EAAE;UAACa,KAAK,EAACR,MAAM,CAACE,IAAI;UAAEG,QAAQ,EAAE;QAAE,CAClD,CAAC;QACD,OAAO,CACH,GAAGN,KAAK,EACR;UACIJ,EAAE,EAAEK,MAAM,CAACL,EAAE;UACba,KAAK,EAAER,MAAM,CAACE,IAAI;UAClBG,QAAQ,EAAE;QACd,CAAC,CACJ;MACL;IAIJ,KAAKjB,SAAS,CAACE,MAAM;MAEjB;AACZ;AACA;MACY,IAAIG,QAAQ,CAACM,KAAK,EAAEC,MAAM,CAACH,IAAI,CAACM,MAAM,CAAC,EAAE;QACrC,MAAMM,QAAQ,GAAGV,KAAK,CAACK,GAAG,CAAEP,IAAI,IAC5BA,IAAI,CAACF,EAAE,KAAKK,MAAM,CAACH,IAAI,CAACM,MAAM,GACxB;UAAE,GAAGN,IAAI;UAAEQ,QAAQ,EAAER,IAAI,CAACQ,QAAQ,GAAG;QAAE,CAAC,GACxCR,IACV,CAAC,CACIa,MAAM,CAAEb,IAAI,IAAKA,IAAI,CAACQ,QAAQ,IAAI,CAAC,CAAC;QAEzCM,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAAC,CAAC;QACtD,OAAOA,QAAQ;QACf;QACA;QACA;QACA;QACA;QACA;MACJ,CAAC,MAAI;QACDE,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACf,KAAK,CAAC,CAAC;QACnD,OAAOA,KAAK;MAChB;IAGJ,KAAKX,SAAS,CAACG,KAAK;MAChB,MAAMkB,QAAQ,GAAGjB,gBAAgB;MACjCmB,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAAC,CAAC;MACtD;MACA,OAAOA,QAAQ;IACnB;MACI,MAAM,IAAIM,KAAK,CAAE,uBAAsBf,MAAM,CAACC,IAAK,EAAC,CAAC;EAC7D;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
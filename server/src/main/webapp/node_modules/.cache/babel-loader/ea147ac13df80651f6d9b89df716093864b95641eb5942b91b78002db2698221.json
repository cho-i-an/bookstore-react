{"ast":null,"code":"export const CartTypes = {\n  ADD: 'ADD',\n  REMOVE: 'REMOVE',\n  CLEAR: 'CLEAR'\n};\nexport const initialCartState = [];\nconst findItem = (cart, id) => cart.find(book => book.id === id);\nexport const cartReducer = (state, action) => {\n  let newState;\n  // console.log(\"HHHH\")\n  switch (action.type) {\n    case CartTypes.ADD:\n      if (findItem(state, action.book.bookId)) {\n        const newState = state.map(book => book.id === action.book.bookId ? {\n          ...book,\n          quantity: book.quantity + 1\n        } : book);\n        localStorage.setItem('cart', JSON.stringify(newState));\n        return newState;\n      } else {\n        const newState = [...state, {\n          id: action.id,\n          book: action.book,\n          quantity: 1\n        }];\n        localStorage.setItem('cart', JSON.stringify(newState));\n\n        // ];\n        return newState;\n      }\n    case CartTypes.REMOVE:\n      /*\n         will be defiend in Project 7\n       */\n      if (findItem(state, action.book.bookId)) {\n        const newState = state.map(book => book.id === action.book.bookId ? {\n          ...book,\n          quantity: book.quantity - 1\n        } : book).filter(book => book.quantity >= 1);\n        localStorage.setItem('cart', JSON.stringify(newState));\n        return newState;\n      } else {\n        localStorage.setItem('cart', JSON.stringify(state));\n        return state;\n      }\n    case CartTypes.CLEAR:\n      const newState = initialCartState;\n      localStorage.setItem('cart', JSON.stringify(newState));\n      // state = initialCartState;\n      return newState;\n    default:\n      throw new Error(`Invalid action type ${action.type}`);\n  }\n};","map":{"version":3,"names":["CartTypes","ADD","REMOVE","CLEAR","initialCartState","findItem","cart","id","find","book","cartReducer","state","action","newState","type","bookId","map","quantity","localStorage","setItem","JSON","stringify","filter","Error"],"sources":["/Users/ann/Desktop/CS5244/IAnBookstoreReactSession/client/src/reducers/CartReducer.tsx"],"sourcesContent":["import {ShoppingCartItem, BookItem} from \"../types\";\nimport {Dispatch, ReducerAction} from \"react\";\n\n\nexport const CartTypes = {\n    ADD: 'ADD',\n    REMOVE: 'REMOVE',\n    CLEAR: 'CLEAR'\n};\n\nexport type AppActions = {\n    id: number;\n    type: 'ADD' | 'REMOVE' | 'CLEAR';\n    book: BookItem;\n}\n\nexport const initialCartState: ShoppingCartItem[] = [];\n\n\nconst findItem = (cart: any[], id: number) => cart.find((book) => book.id === id);\n\nexport const cartReducer = (state: ShoppingCartItem[],action: { type: any; book: { bookId: number; }; id: any; }) => {\n    let newState: ShoppingCartItem[];\n    // console.log(\"HHHH\")\n    switch (action.type) {\n        case CartTypes.ADD:\n\n\n            if (findItem(state, action.book.bookId)) {\n\n                const newState = state.map((book) => book.id === action.book.bookId ? {\n                    ...book,\n                    quantity: book.quantity + 1\n                } : book);\n\n\n                localStorage.setItem('cart', JSON.stringify(newState));\n\n                return newState;\n            } else {\n                const newState = [\n                    ...state,\n                    {\n                        id: action.id,\n                        book: action.book,\n                        quantity: 1\n                    }\n                ];\n\n                localStorage.setItem('cart', JSON.stringify(newState));\n\n                // ];\n                return newState;\n            }\n\n\n\n        case CartTypes.REMOVE:\n\n            /*\n               will be defiend in Project 7\n             */\n            if (findItem(state, action.book.bookId)) {\n                const newState = state.map((book) =>\n                    book.id === action.book.bookId\n                        ? { ...book, quantity: book.quantity - 1 }\n                        : book\n                )\n                    .filter((book) => book.quantity >= 1);\n\n                localStorage.setItem('cart', JSON.stringify(newState));\n                return newState\n\n            }else{\n                localStorage.setItem('cart', JSON.stringify(state));\n                return state\n            }\n\n\n        case CartTypes.CLEAR:\n            const newState = initialCartState\n            localStorage.setItem('cart', JSON.stringify(newState));\n            // state = initialCartState;\n            return newState;\n        default:\n            throw new Error(`Invalid action type ${action.type}`);\n\n\n    }\n\n};"],"mappings":"AAIA,OAAO,MAAMA,SAAS,GAAG;EACrBC,GAAG,EAAE,KAAK;EACVC,MAAM,EAAE,QAAQ;EAChBC,KAAK,EAAE;AACX,CAAC;AAQD,OAAO,MAAMC,gBAAoC,GAAG,EAAE;AAGtD,MAAMC,QAAQ,GAAGA,CAACC,IAAW,EAAEC,EAAU,KAAKD,IAAI,CAACE,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACF,EAAE,KAAKA,EAAE,CAAC;AAEjF,OAAO,MAAMG,WAAW,GAAGA,CAACC,KAAyB,EAACC,MAA0D,KAAK;EACjH,IAAIC,QAA4B;EAChC;EACA,QAAQD,MAAM,CAACE,IAAI;IACf,KAAKd,SAAS,CAACC,GAAG;MAGd,IAAII,QAAQ,CAACM,KAAK,EAAEC,MAAM,CAACH,IAAI,CAACM,MAAM,CAAC,EAAE;QAErC,MAAMF,QAAQ,GAAGF,KAAK,CAACK,GAAG,CAAEP,IAAI,IAAKA,IAAI,CAACF,EAAE,KAAKK,MAAM,CAACH,IAAI,CAACM,MAAM,GAAG;UAClE,GAAGN,IAAI;UACPQ,QAAQ,EAAER,IAAI,CAACQ,QAAQ,GAAG;QAC9B,CAAC,GAAGR,IAAI,CAAC;QAGTS,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAAC,CAAC;QAEtD,OAAOA,QAAQ;MACnB,CAAC,MAAM;QACH,MAAMA,QAAQ,GAAG,CACb,GAAGF,KAAK,EACR;UACIJ,EAAE,EAAEK,MAAM,CAACL,EAAE;UACbE,IAAI,EAAEG,MAAM,CAACH,IAAI;UACjBQ,QAAQ,EAAE;QACd,CAAC,CACJ;QAEDC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAAC,CAAC;;QAEtD;QACA,OAAOA,QAAQ;MACnB;IAIJ,KAAKb,SAAS,CAACE,MAAM;MAEjB;AACZ;AACA;MACY,IAAIG,QAAQ,CAACM,KAAK,EAAEC,MAAM,CAACH,IAAI,CAACM,MAAM,CAAC,EAAE;QACrC,MAAMF,QAAQ,GAAGF,KAAK,CAACK,GAAG,CAAEP,IAAI,IAC5BA,IAAI,CAACF,EAAE,KAAKK,MAAM,CAACH,IAAI,CAACM,MAAM,GACxB;UAAE,GAAGN,IAAI;UAAEQ,QAAQ,EAAER,IAAI,CAACQ,QAAQ,GAAG;QAAE,CAAC,GACxCR,IACV,CAAC,CACIa,MAAM,CAAEb,IAAI,IAAKA,IAAI,CAACQ,QAAQ,IAAI,CAAC,CAAC;QAEzCC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAAC,CAAC;QACtD,OAAOA,QAAQ;MAEnB,CAAC,MAAI;QACDK,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACV,KAAK,CAAC,CAAC;QACnD,OAAOA,KAAK;MAChB;IAGJ,KAAKX,SAAS,CAACG,KAAK;MAChB,MAAMU,QAAQ,GAAGT,gBAAgB;MACjCc,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAAC,CAAC;MACtD;MACA,OAAOA,QAAQ;IACnB;MACI,MAAM,IAAIU,KAAK,CAAE,uBAAsBX,MAAM,CAACE,IAAK,EAAC,CAAC;EAG7D;AAEJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}